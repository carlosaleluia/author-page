---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getSortedBooks } from '../../lib/books';

const books = await getSortedBooks();
---

<BaseLayout title="Livros - Carlos Aleluia">

	<style>
		.page-header {
			padding: 5rem 0 4rem;
			border-bottom: 1px solid var(--border-color);
		}

		.page-header h1 {
			font-size: 3rem;
			font-weight: 300;
			letter-spacing: -1px;
		}

		.books-grid {
			padding: 4rem 0;
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
			gap: 3rem;
		}

		.book-card {
			text-align: center;
		}

		.book-cover {
			width: 100%;
			aspect-ratio: 2/3;
			background: var(--placeholder-bg);
			margin-bottom: 1.5rem;
			overflow: hidden;
			border-radius: 4px;
		}

		.book-card > a {
			display: block;
		}

		.book-cover img {
			width: 100%;
			height: 100%;
			object-fit: cover;
			display: block;
		}

		.book-card h2 {
			font-size: 1.5rem;
			font-weight: 400;
			margin-bottom: 0.75rem;
			letter-spacing: -0.5px;
		}

		.book-card h2 a {
			text-decoration: none;
			color: var(--text-primary);
			transition: color 0.2s;
		}

		.book-card h2 a:hover {
			color: var(--text-secondary);
		}

		.book-meta {
			color: var(--text-secondary);
			font-size: 0.9rem;
			margin-bottom: 1rem;
		}

		.book-description {
			font-size: 0.95rem;
			line-height: 1.6;
			color: var(--text-secondary);
		}

		@media (max-width: 768px) {
			.page-header h1 {
				font-size: 2.2rem;
			}

			.books-grid {
				grid-template-columns: 1fr;
				gap: 2.5rem;
			}
		}
	</style>

	<div class="container">
		<header class="page-header">
			<h1>Livros</h1>
		</header>

		<section class="books-grid">
			{books.map((book) => (
				<article class="book-card">
					<a href={`/livros/${book.id}`}>
						<div class="book-cover">
							{book.data.coverImage ? (
								<img src={book.data.coverImage} alt={book.data.title} loading="lazy" />
							) : (
								<div style="width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
							)}
						</div>
					</a>
					<h2>
						<a href={`/livros/${book.id}`}>{book.data.title}</a>
					</h2>
					<p class="book-meta">
						{book.data.pubDate.toLocaleDateString('pt-PT', {
							year: 'numeric',
							month: 'long'
						})}
					</p>
					<p class="book-description">{book.data.description}</p>
				</article>
			))}
		</section>
	</div>
</BaseLayout>