---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
	const books = await getCollection('blog');

	return books.map((book) => ({
		params: { slug: book.id },
		props: { book },
	}));
}

const { book } = Astro.props;
const { Content } = await render(book);
---

<BaseLayout title={`${book.data.title} - Carlos Aleluia`}>
	<style>
		.back-link {
			display: inline-block;
			margin-bottom: 2rem;
			color: var(--text-secondary);
			text-decoration: none;
			font-size: 0.95rem;
			transition: color 0.2s;
		}

		.back-link:hover {
			color: var(--text-primary);
		}

		.book-header {
			padding: 5rem 0 4rem;
			border-bottom: 1px solid var(--border-color);
		}

		.book-header h1 {
			font-size: 3.5rem;
			font-weight: 300;
			letter-spacing: -1px;
			margin-bottom: 1.5rem;
			line-height: 1.2;
		}

		.book-meta {
			color: var(--text-secondary);
			font-size: 0.9rem;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.book-content {
			padding: 4rem 0;
			font-size: 1.1rem;
			line-height: 1.9;
		}

		.book-content h2 {
			font-size: 1.8rem;
			font-weight: 400;
			margin: 3rem 0 1.5rem;
			letter-spacing: -0.5px;
		}

		.book-content h3 {
			font-size: 1.4rem;
			font-weight: 400;
			margin: 2.5rem 0 1rem;
		}

		.book-content p {
			margin-bottom: 1.5rem;
		}

		.book-content blockquote {
			border-left: 3px solid var(--border-color);
			padding-left: 2rem;
			margin: 2rem 0;
			font-style: italic;
			color: var(--text-secondary);
		}

		.book-content a {
			color: var(--text-primary);
			text-decoration: underline;
			text-underline-offset: 3px;
		}

		.book-content ul, .book-content ol {
			margin: 1.5rem 0;
			padding-left: 2rem;
		}

		.book-content li {
			margin-bottom: 0.75rem;
		}

		@media (max-width: 768px) {
			.book-header h1 {
				font-size: 2.5rem;
			}

			.book-content {
				font-size: 1.05rem;
			}
		}
	</style>

	<div class="container">
		<a href="/livros" class="back-link">‚Üê Voltar aos livros</a>

		<header class="book-header">
			<h1>{book.data.title}</h1>
			<p class="book-meta">
				{book.data.pubDate.toLocaleDateString('pt-PT', {
					year: 'numeric',
					month: 'long'
				})}
			</p>
		</header>

		<article class="book-content">
			<Content />
		</article>
	</div>
</BaseLayout>